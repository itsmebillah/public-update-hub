<!DOCTYPE html>
<html lang="bn">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ‡¶¶‡ßá‡¶∂ ‡¶™‡¶æ‡¶¨‡¶≤‡¶ø‡¶ï ‡¶Ü‡¶™‡¶°‡ßá‡¶ü ‡¶π‡¶æ‡¶¨</title>
  <style>
    body {
      margin: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
      background: #f8f9fa;
      color: #212529;
    }
    .topbar {
      position: sticky;
      top: 0;
      background: #ffffff;
      border-bottom: 1px solid #dee2e6;
      padding: 16px;
      z-index: 100;
      box-shadow: 0 2px 4px rgba(0,0,0,0.05);
    }
    .logo {
      font-size: 1.5rem;
      font-weight: 700;
      color: #198754;
    }
    .subtitle {
      font-size: 0.95rem;
      color: #6c757d;
      margin-top: 4px;
    }
    .categories {
      display: flex;
      gap: 12px;
      margin-top: 12px;
      overflow-x: auto;
      padding-bottom: 4px;
    }
    .categories span {
      padding: 8px 16px;
      font-size: 0.9rem;
      background: #e9ecef;
      border-radius: 50px;
      white-space: nowrap;
      cursor: pointer;
      transition: background 0.2s;
    }
    .categories span:hover, .categories span.active {
      background: #198754;
      color: white;
    }
    .feed {
      max-width: 800px;
      margin: 0 auto;
      padding: 16px;
    }
    .news-item {
      background: white;
      border-radius: 8px;
      padding: 16px;
      margin-bottom: 16px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
      cursor: pointer;
      transition: transform 0.2s;
    }
    .news-item:hover {
      transform: translateY(-2px);
    }
    .news-thumbnail {
      width: 100%;
      height: 200px;
      object-fit: cover;
      border-radius: 6px;
      margin-bottom: 12px;
    }
    .news-title {
      font-size: 1.1rem;
      font-weight: 600;
      line-height: 1.4;
      margin-bottom: 8px;
    }
    .meta {
      font-size: 0.85rem;
      color: #6c757d;
      margin-bottom: 8px;
    }
    .summary {
      font-size: 0.95rem;
      color: #495057;
      line-height: 1.5;
    }
    .loader {
      text-align: center;
      padding: 20px;
      color: #6c757d;
      font-size: 0.9rem;
    }
    .end-message {
      text-align: center;
      padding: 20px;
      color: #6c757d;
      font-size: 0.9rem;
    }
    footer {
      text-align: center;
      padding: 40px 16px;
      font-size: 0.9rem;
      color: #6c757d;
      border-top: 1px solid #dee2e6;
    }
  </style>
</head>
<body>
  <!-- Top -->
  <div class="topbar">
    <div class="logo">‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ‡¶¶‡ßá‡¶∂ ‡¶™‡¶æ‡¶¨‡¶≤‡¶ø‡¶ï ‡¶Ü‡¶™‡¶°‡ßá‡¶ü ‡¶π‡¶æ‡¶¨</div>
    <div class="subtitle">
      ‡¶∏‡¶∞‡¶ï‡¶æ‡¶∞‡¶ø ‡¶ö‡¶æ‡¶ï‡¶∞‡¶ø, ‡¶∂‡¶ø‡¶ï‡ßç‡¶∑‡¶æ ‡¶ì ‡¶ó‡ßÅ‡¶∞‡ßÅ‡¶§‡ßç‡¶¨‡¶™‡ßÇ‡¶∞‡ßç‡¶£ ‡¶®‡ßã‡¶ü‡¶ø‡¶∂ ‚Äî ‡¶Ö‡¶´‡¶ø‡¶∏‡¶ø‡ßü‡¶æ‡¶≤ ‡¶∏‡ßã‡¶∞‡ßç‡¶∏ ‡¶•‡ßá‡¶ï‡ßá
    </div>
    <div class="categories">
      <span data-category="" class="active">üî• ‡¶π‡¶ü</span>
      <span data-category="jobs">‡¶ö‡¶æ‡¶ï‡¶∞‡¶ø</span>
      <span data-category="education">‡¶∂‡¶ø‡¶ï‡ßç‡¶∑‡¶æ</span>
      <span data-category="tech">‡¶ü‡ßá‡¶ï</span>
    </div>
  </div>
  <!-- Feed -->
  <div class="feed" id="feed"></div>
  <!-- Footer -->
  <footer>
    ¬© ‡ß®‡ß¶‡ß®‡ß™ ‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ‡¶¶‡ßá‡¶∂ ‡¶™‡¶æ‡¶¨‡¶≤‡¶ø‡¶ï ‡¶Ü‡¶™‡¶°‡ßá‡¶ü ‡¶π‡¶æ‡¶¨ <br />
    ‡¶∏‡¶Æ‡¶∏‡ßç‡¶§ ‡¶§‡¶•‡ßç‡¶Ø ‡¶∏‡¶Ç‡¶∂‡ßç‡¶≤‡¶ø‡¶∑‡ßç‡¶ü ‡¶Ö‡¶´‡¶ø‡¶∏‡¶ø‡ßü‡¶æ‡¶≤ ‡¶∏‡ßã‡¶∞‡ßç‡¶∏ ‡¶•‡ßá‡¶ï‡ßá ‡¶∏‡¶Ç‡¶ó‡ßÉ‡¶π‡ßÄ‡¶§
  </footer>

  <!-- JS -->
  <script>
    const feed = document.getElementById("feed");
    const categoryButtons = document.querySelectorAll(".categories span");
    const seenUrls = new Set();
    let currentCategory = "";
    let page = 1;
    const limit = 10;
    let loading = false;
    let reachedEnd = false;

    function loadNews(reset = false) {
      if (loading || reachedEnd) return;
      loading = true;

      if (reset) {
        feed.innerHTML = "";
        page = 1;
        reachedEnd = false;
        seenUrls.clear();
      }

      const url = `https://news-backend-production-5cf9.up.railway.app/news?page=${page}&limit=${limit}${currentCategory ? `&category=${currentCategory}` : ''}`;

      const loader = document.createElement("div");
      loader.className = "loader";
      loader.innerText = "‡¶≤‡ßã‡¶° ‡¶π‡¶ö‡ßç‡¶õ‡ßá...";
      feed.appendChild(loader);

      fetch(url)
        .then(res => res.json())
        .then(data => {
          loader.remove();
          loading = false;

          if (!data.articles || data.articles.length === 0) {
            reachedEnd = true;
            const endMsg = document.createElement("div");
            endMsg.className = "end-message";
            endMsg.innerText = "‡¶Ü‡¶∞ ‡¶ï‡ßã‡¶®‡ßã ‡¶®‡¶ø‡¶â‡¶ú ‡¶®‡ßá‡¶á‡•§";
            feed.appendChild(endMsg);
            return;
          }

          data.articles.forEach(item => {
            if (seenUrls.has(item.url)) return;
            seenUrls.add(item.url);

            const div = document.createElement("div");
            div.className = "news-item";
            div.innerHTML = `
              ${item.thumbnail ? `<img src="${item.thumbnail}" alt="${item.title}" class="news-thumbnail">` : ''}
              <div class="news-title">${item.title}</div>
              <div class="meta">${item.source || "Unknown"} ‚Ä¢ ${item.category} ‚Ä¢ ${item.published}</div>
              <div class="summary">${item.summary}</div>
            `;
            div.onclick = () => window.open(item.url, "_blank");
            feed.appendChild(div);
          });

          if (!data.has_more) {
            reachedEnd = true;
          }

          page++;
        })
        .catch(err => {
          loader.remove();
          loading = false;
          console.error("Fetch error:", err);
          const errorMsg = document.createElement("div");
          errorMsg.className = "loader";
          errorMsg.innerText = "‡¶≤‡ßã‡¶°‡¶ø‡¶Ç ‡¶è ‡¶§‡ßç‡¶∞‡ßÅ‡¶ü‡¶ø ‡¶π‡ßü‡ßá‡¶õ‡ßá‡•§ ‡¶Ü‡¶¨‡¶æ‡¶∞ ‡¶ö‡ßá‡¶∑‡ßç‡¶ü‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶®‡•§";
          feed.appendChild(errorMsg);
        });
    }

    // Initial load
    loadNews(true);

    // Category click
    categoryButtons.forEach(btn => {
      btn.addEventListener("click", () => {
        categoryButtons.forEach(b => b.classList.remove("active"));
        btn.classList.add("active");
        currentCategory = btn.getAttribute("data-category") || "";
        loadNews(true);
      });
    });

    // Infinite scroll
    window.addEventListener("scroll", () => {
      if (window.innerHeight + window.scrollY >= document.body.offsetHeight - 300) {
        loadNews();
      }
    });

    // Auto refresh every 5 min
    const REFRESH_INTERVAL = 5 * 60 * 1000;
    setInterval(() => {
      console.log("Refreshing...");
      loadNews(true);
    }, REFRESH_INTERVAL);
  </script>
</body>
</html>
